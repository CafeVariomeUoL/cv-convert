<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Runtime</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cv-convert-0.5</span><ul class="links" id="page-menu"><li><a href="src/Runtime.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Samuel Balco 2020</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>sam@definitelynotspam.email</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Runtime</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The runtime module exports the main functionality of the cv-convert tool.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:loadLibrary">loadLibrary</a> :: (<a href="../conduit-1.3.2/Conduit.html#t:MonadThrow" title="Conduit">MonadThrow</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; <a href="Runtime-Types.html#t:LibFunctions" title="Runtime.Types">LibFunctions</a> -&gt; m ()</li><li class="src short"><a href="#v:convertRow">convertRow</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m) =&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; row -&gt; header -&gt; (row -&gt; header -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</li><li class="src short"><a href="#v:processRow">processRow</a> :: (<a href="../lens-4.18.1/Control-Lens-Indexed.html#t:FoldableWithIndex" title="Control.Lens.Indexed">FoldableWithIndex</a> <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> f, <a href="../conduit-1.3.2/Conduit.html#t:MonadThrow" title="Conduit">MonadThrow</a> m) =&gt; f row -&gt; (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; row -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))) -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</li><li class="src short"><a href="#v:processTxtFile">processTxtFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</li><li class="src short"><a href="#v:processXlsxFile">processXlsxFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; <a href="../base-4.13.0.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Runtime-Types.html#t:SheetName" title="Runtime.Types">SheetName</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</li><li class="src short"><a href="#v:processCsvFile">processCsvFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</li><li class="src short"><a href="#v:processJsonFile">processJsonFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</li><li class="src short"><a href="#v:processFile">processFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:FileType" title="Runtime.Types">FileType</a> -&gt; <a href="Runtime-Types.html#t:DataOutputOpt" title="Runtime.Types">DataOutputOpt</a> -&gt; <a href="Runtime-Types.html#t:ErrorOpt" title="Runtime.Types">ErrorOpt</a> -&gt; m ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:loadLibrary" class="def">loadLibrary</a> :: (<a href="../conduit-1.3.2/Conduit.html#t:MonadThrow" title="Conduit">MonadThrow</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; <a href="Runtime-Types.html#t:LibFunctions" title="Runtime.Types">LibFunctions</a> -&gt; m () <a href="src/Runtime.html#loadLibrary" class="link">Source</a> <a href="#v:loadLibrary" class="selflink">#</a></p><div class="doc"><p>The <code><a href="Runtime.html#v:loadLibrary" title="Runtime">loadLibrary</a></code> function takse a <code><a href="Runtime-Types.html#t:LibFunctions" title="Runtime.Types">LibFunctions</a></code> parameter, which either contains an inline JS script or points
to an external script via URL. The library functions must be stored in a specific way, namely the library file must
be of the form</p><pre>Lib.fun1 = (a,b) =&gt; {...},
Lib.fun2 = ...</pre></div></div><div class="top"><p class="src"><a id="v:convertRow" class="def">convertRow</a> <a href="src/Runtime.html#convertRow" class="link">Source</a> <a href="#v:convertRow" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Row index/counter</p></td></tr><tr><td class="src">-&gt; row</td><td class="doc"><p>Row data</p></td></tr><tr><td class="src">-&gt; header</td><td class="doc"><p>Row header</p></td></tr><tr><td class="src">-&gt; (row -&gt; header -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)</td><td class="doc"><p>Coverter function taking the row and header returning a JSON <code><a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a></code></p></td></tr><tr><td class="src">-&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>])</td><td class="doc"><p>Validator function, used to check that the output of the converter function
 conforms to the JSON schema, specified in <code><a href="Runtime-Types.html#v:jsonSchema" title="Runtime.Types">jsonSchema</a></code></p></td></tr><tr><td class="src">-&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a></td><td class="doc"><p>Either a Database connection or a file handle, 
 depending on where we output data</p></td></tr><tr><td class="src">-&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a></td><td class="doc"><p>Row data as JSON</p></td></tr><tr><td class="src">-&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</td><td class="doc"><p>returns a map from JSON <code><a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a></code>s to a set of <code><a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a></code>s, 
 by calling <code><a href="JSON-Utils.html#v:createAllPathsWithValues" title="JSON.Utils">createAllPathsWithValues</a></code> on the converter function output</p></td></tr></table></div><div class="doc"><p>This function runs the converter function on the row and header input data, 
then runs the validator(to check that the JSON <code><a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a></code> that was produced validates
agains the JSON schema).</p><p>If the output is valid, the data is either stored in a database or a JSON text file.
When inserting into database, the output is stored in two different tables:</p><ul><li>The <code>insertJSONBOverwriteOnConflict</code> function stores the data as Postgres JSONB in the 
    <code>eavs_jsonb_attributes_values</code> table</li><li><code><a href="JSON-Utils.html#v:flattenToEAV" title="JSON.Utils">flattenToEAV</a></code> is used to generate flattened EAV triples form the given JOSn object, which are
    then stored in the <code>eavs</code> table via <code><a href="DB.html#v:insertEAV" title="DB">insertEAV</a></code></li></ul><p>Finally, we return result of running <code><a href="JSON-Utils.html#v:createAllPathsWithValues" title="JSON.Utils">createAllPathsWithValues</a></code> on the JSON output data.</p></div></div><div class="top"><p class="src"><a id="v:processRow" class="def">processRow</a> <a href="src/Runtime.html#processRow" class="link">Source</a> <a href="#v:processRow" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../lens-4.18.1/Control-Lens-Indexed.html#t:FoldableWithIndex" title="Control.Lens.Indexed">FoldableWithIndex</a> <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> f, <a href="../conduit-1.3.2/Conduit.html#t:MonadThrow" title="Conduit">MonadThrow</a> m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; f row</td><td class="doc"><p>Any list like data structure containing rows we can loop over with an index</p></td></tr><tr><td class="src">-&gt; (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; row -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)))</td><td class="doc"><p>Function that consumes the row together with it's index</p></td></tr><tr><td class="src">-&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>))</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Helper function which loops over the rows of the given input, 
collecting and merging all the resulting maps (generated inside <code><a href="Runtime.html#v:convertRow" title="Runtime">convertRow</a></code> via <code><a href="JSON-Utils.html#v:createAllPathsWithValues" title="JSON.Utils">createAllPathsWithValues</a></code>) </p></div></div><div class="top"><p class="src"><a id="v:processTxtFile" class="def">processTxtFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)) <a href="src/Runtime.html#processTxtFile" class="link">Source</a> <a href="#v:processTxtFile" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:processXlsxFile" class="def">processXlsxFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; <a href="../base-4.13.0.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Runtime-Types.html#t:SheetName" title="Runtime.Types">SheetName</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)) <a href="src/Runtime.html#processXlsxFile" class="link">Source</a> <a href="#v:processXlsxFile" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:processCsvFile" class="def">processCsvFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)) <a href="src/Runtime.html#processCsvFile" class="link">Source</a> <a href="#v:processCsvFile" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:processJsonFile" class="def">processJsonFile</a> :: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m) =&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>) -&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>]) -&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Runtime-Types.html#t:DataOutput" title="Runtime.Types">DataOutput</a> -&gt; <a href="Runtime-Types.html#t:ErrorHandling" title="Runtime.Types">ErrorHandling</a> -&gt; m (<a href="../postgresql-binary-0.12.2/PostgreSQL-Binary-Data.html#t:HashMap" title="PostgreSQL.Binary.Data">HashMap</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> (<a href="../unordered-containers-0.2.10.0/Data-HashSet.html#t:HashSet" title="Data.HashSet">HashSet</a> <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)) <a href="src/Runtime.html#processJsonFile" class="link">Source</a> <a href="#v:processJsonFile" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:processFile" class="def">processFile</a> <a href="src/Runtime.html#processFile" class="link">Source</a> <a href="#v:processFile" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m, <a href="../base-4.13.0.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../adjunctions-4.4/Control-Monad-Representable-Reader.html#t:MonadReader" title="Control.Monad.Representable.Reader">MonadReader</a> JSContextPtr m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (JSValue -&gt; JSValue -&gt; m <a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a>)</td><td class="doc"><p>Function taking the row and header <code>JSValue</code>s, returning a JSON <code><a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a></code></p></td></tr><tr><td class="src">-&gt; (<a href="../aeson-1.4.7.1/Data-Aeson-Types.html#t:Value" title="Data.Aeson.Types">Value</a> -&gt; [<a href="../hjsonschema-1.10.0/JSONSchema-Draft4-Failure.html#t:ValidatorFailure" title="JSONSchema.Draft4.Failure">ValidatorFailure</a>])</td><td class="doc"><p>Validator function, used to check that the output of the converter function
 conforms to the JSON schema, specified in <code><a href="Runtime-Types.html#v:jsonSchema" title="Runtime.Types">jsonSchema</a></code></p></td></tr><tr><td class="src">-&gt; <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a></td><td class="doc"><p>Path of the input file</p></td></tr><tr><td class="src">-&gt; <a href="Runtime-Types.html#t:FileType" title="Runtime.Types">FileType</a></td><td class="doc"><p>Number of rows to skip/row number to start from only used when <code><a href="Runtime-Types.html#t:FileType" title="Runtime.Types">FileType</a></code> is <code><a href="Runtime-Types.html#v:TXTFile" title="Runtime.Types">TXTFile</a></code>. Default is 0.
 Optional sheet name only used when <code><a href="Runtime-Types.html#t:FileType" title="Runtime.Types">FileType</a></code> is <code><a href="Runtime-Types.html#v:XLSXFile" title="Runtime.Types">XLSXFile</a></code>.</p></td></tr><tr><td class="src">-&gt; <a href="Runtime-Types.html#t:DataOutputOpt" title="Runtime.Types">DataOutputOpt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Runtime-Types.html#t:ErrorOpt" title="Runtime.Types">ErrorOpt</a></td><td class="doc"><p>Describes the error behaviour when parsing a row of the input. </p></td></tr><tr><td class="src">-&gt; m ()</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>